<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AI Content Creator Manager</title>
<style>
:root {
  --gold: #ffb300;
  --dark1: #101010;
  --dark2: #181818;
  --dark3: #222;
  --text: #f5f5f5;
  --accent: #ffb300;
}
* {box-sizing:border-box;}
body {
  margin:0; font-family:'Inter',sans-serif; background:var(--dark1); color:var(--text);
  display:flex; height:100vh; overflow:hidden;
}
aside {
  width:260px; background:linear-gradient(180deg,var(--dark2),#0d0d0d);
  border-right:1px solid var(--dark3); padding:20px;
  display:flex; flex-direction:column; align-items:stretch;
}
aside h1 {color:var(--gold); font-size:1.3em; margin-bottom:15px; text-transform:uppercase; letter-spacing:1px;}
aside button {
  background:#1a1a1a; color:var(--text); border:1px solid var(--dark3);
  border-radius:6px; padding:10px; margin-bottom:8px; cursor:pointer;
  transition:all 0.25s ease; font-weight:600;
}
aside button:hover {background:var(--gold); color:#000;}
#channelList {
  flex:1; overflow-y:auto; margin-top:10px; border-top:1px solid var(--dark3); padding-top:10px;
}
.channel {
  background:#1c1c1c; border:1px solid var(--dark3); border-radius:5px;
  padding:10px; margin-bottom:8px;
}
.channel span {color:var(--gold); font-weight:600;}

main {
  flex:1; padding:20px; overflow-y:auto; background:var(--dark2);
}
header {
  color:var(--gold); font-size:1.8em; font-weight:600;
  text-shadow:0 0 8px var(--gold); margin-bottom:20px;
}
.section {
  background:#141414; border:1px solid var(--dark3); border-radius:8px;
  padding:15px; margin-bottom:15px;
}
.section h2 {
  color:var(--gold); margin-bottom:10px; font-size:1.2em;
}
.flex-row {display:flex; gap:10px; flex-wrap:wrap;}
.action-btn {
  background:#1f1f1f; color:var(--text); border:1px solid var(--dark3);
  border-radius:6px; padding:10px 14px; cursor:pointer; transition:0.25s;
}
.action-btn:hover {background:var(--gold); color:#000;}
.status-dot {width:10px;height:10px;border-radius:50%;display:inline-block;margin-right:6px;}
.green {background:#00e676;} .yellow{background:#ffd600;} .red{background:#f44336;}
.log {background:#0d0d0d; color:#ccc; padding:10px; height:150px; overflow-y:auto; border-radius:5px; font-family:monospace; font-size:0.9em;}
.card-grid {display:grid; grid-template-columns:repeat(auto-fill,minmax(180px,1fr)); gap:10px;}
.card {
  background:#1a1a1a; border:1px solid var(--dark3); border-radius:8px; padding:12px;
  text-align:center; transition:0.25s;
}
.card:hover {transform:translateY(-2px); border-color:var(--gold);}
.card h3 {color:var(--gold); margin:0 0 6px;}
.metric {font-size:1.1em; font-weight:600;}
small {color:#aaa;}
</style>
</head>
<body>
<aside>
  <h1>Studio Manager</h1>
  <button id="refreshChannels">🔄 Refresh Channels</button>
  <button id="runAll">🚀 Run All Channels</button>
  <button id="fetchTrends">🌍 Fetch Trends</button>
  <button id="checkResources">🧩 Check Resources</button>
  <button id="openAnalytics">📊 Show Analytics</button>
  <button id="authYouTube">🎥 Authorize YouTube</button>
  <div id="channelList">Loading channels...</div>
</aside>
<main>
  <header>AI Content Creator Manager</header>

  <div class="section">
    <h2>⚡ Quick Actions</h2>
    <div class="flex-row">
      <button class="action-btn" id="generateScript">📝 Generate Script</button>
      <button class="action-btn" id="createVideo">🎬 Create Video</button>
      <button class="action-btn" id="uploadYouTube">⬆️ Upload to YouTube</button>
      <button class="action-btn" id="optimizeAI">🤖 AI Optimize</button>
      <button class="action-btn" id="refreshLogs">📜 Clear Logs</button>
    </div>
  </div>

  <div class="section" id="analyticsSection">
    <h2>📊 Channel Analytics</h2>
    <div class="card-grid" id="analyticsGrid">
      <div class="card"><h3>Horror Factory</h3><div class="metric">98% Success</div><small>Last 24h</small></div>
    </div>
  </div>

  <div class="section">
    <h2>🧠 Resource Monitor</h2>
    <div id="resources">
      <p><span class="status-dot green"></span>Freesound API</p>
      <p><span class="status-dot green"></span>Replicate API</p>
      <p><span class="status-dot green"></span>TTS Engine</p>
      <p><span class="status-dot green"></span>Google Sheets</p>
    </div>
  </div>

  <div class="section" id="trendsSection">
    <h2>🔥 Global & YouTube Trends</h2>
    <div id="trendsContainer">Press “Fetch Trends” to load global data.</div>
  </div>

  <div class="section">
    <h2>📜 System Log</h2>
    <div id="systemLog" class="log"></div>
  </div>
</main>

<script>
const log = msg => {
  const el = document.getElementById('systemLog');
  const time = new Date().toLocaleTimeString();
  el.innerHTML += '[' + time + '] ' + msg + '<br>';
  el.scrollTop = el.scrollHeight;
};

async function fetchChannels() {
  log('Fetching channels from Google Sheets...');
  try {
    const res = await fetch('/.netlify/functions/google-sheets');
    const data = await res.json();
    const list = document.getElementById('channelList');
    list.innerHTML = '';
    data.forEach(ch => {
      const div = document.createElement('div');
      div.className = 'channel';
      div.innerHTML = '<span>' + ch.channel + '</span><br>' + ch.genre + ' | ' + (ch.status || 'Active');
      list.appendChild(div);
    });
    log('✅ Channels loaded: ' + data.length);
  } catch (err) {
    log('❌ Failed to load channels: ' + err);
  }
}

async function runAllChannels() {
  log('🚀 Running all channels...');
  try {
    const res = await fetch('/.netlify/functions/google-sheets');
    const channels = await res.json();
    for (const ch of channels) {
      log('🎬 Generating for ' + ch.channel + '...');
      await fetch('/.netlify/functions/create-video-real', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify(ch)
      });
      log('✅ Completed ' + ch.channel);
    }
    log('🏁 All channels finished.');
  } catch (err) {
    log('❌ Error running channels: ' + err);
  }
}

async function fetchTrends() {
  log('Fetching global & YouTube trends...');
  try {
    const res = await fetch('https://trends.google.com/trends/api/dailytrends?geo=US');
    const txt = await res.text();
    const json = JSON.parse(txt.replace(")]}',",''));
    const topics = json.default.trendingSearchesDays[0].trendingSearches.map(t => t.title.query);
    document.getElementById('trendsContainer').innerHTML = topics.map(t => '• ' + t).join('<br>');
    log('🌐 Trends updated.');
  } catch (err) {
    log('❌ Failed to fetch trends: ' + err);
  }
}

async function checkResources() {
  log('Checking resource health...');
  const resEl = document.getElementById('resources');
  resEl.innerHTML = '';
  const resources = ['freesound','replicate','tts','google-sheets'];
  for (const r of resources) {
    try {
      await fetch('/.netlify/functions/' + r);
      resEl.innerHTML += `<p><span class="status-dot green"></span>${r} OK</p>`;
    } catch {
      resEl.innerHTML += `<p><span class="status-dot red"></span>${r} Offline</p>`;
    }
  }
  log('✅ Resource check complete.');
}

document.getElementById('refreshChannels').onclick = fetchChannels;
document.getElementById('runAll').onclick = runAllChannels;
document.getElementById('fetchTrends').onclick = fetchTrends;
document.getElementById('checkResources').onclick = checkResources;
document.getElementById('generateScript').onclick = () => log('📝 Trigger script generation (future hook)');
document.getElementById('createVideo').onclick = () => log('🎬 Trigger video creation (future hook)');
document.getElementById('uploadYouTube').onclick = () => log('⬆️ Uploading video to YouTube (future hook)');
document.getElementById('optimizeAI').onclick = () => log('🤖 AI optimization in progress (future hook)');
document.getElementById('refreshLogs').onclick = () => document.getElementById('systemLog').innerHTML='';
document.getElementById('authYouTube').onclick = () => log('🎥 YouTube OAuth placeholder (to be added)');
document.getElementById('openAnalytics').onclick = () => log('📊 Analytics view (coming soon)');

fetchChannels();
</script>
</body>
</html>
